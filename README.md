# Event Map Extension for Radiant

This extension adds google-mapping to the [event_calendar](http://github.com/radiant/radiant-event-calendar-extension). It is controller rather than tag-based, returning predefined page parts that you can include in a radiant layout and style however you prefer.

## Installation

Should be straightforward:

	script/extension install event_map
		
or as a gem:

	gem install radiant-event_map-extension

## Requirements

* [event_calendar](http://github.com/radiant/radiant-event-calendar-extension) extension
* [layouts](http://github.com/squaretalent/radiant-layouts-extension) extension

## Configuration

There is one required config setting:

* `event_map.layout` is the name of the layout used by the controller

## Basic Usage

Create a layout that includes a `map_canvas` div and these page parts:

* `map_js` is required. It brings in the javascripts (and can be used in the header or at the end of the page as you prefer)
* `title` is the page title and can also be shown with `r:title`
* `faceting` here only gives the option to remove any date filters that have been applied. If you add the `taggable_events` extension it gets more useful.

Here's a starting point:

		<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
		  <head>
		    <title><r:title /></title>
		    <r:content part="map_js" />
		  </head>
		  <body>
        <h1 id="pagetitle"><r:title /></h1>
				<r:content part="faceting" />
				<div id="map_canvas" style="width: 600px; height 400px;"></div>
		  </body>
		</html>

Make sure that `Radiant::Config['event_map.layout']` matches exactly the _name_ of this layout.

### javascript compatibility

The map javascript is generated by the EventVenuesController using `app/views/event_venues/index.js.erb`. It provides a `build_map_and_markers` method and the minimal jQuery hook required to populate #map_canvas when the DOM loads.

If you're not using jQuery you should find it straightforward to call `build_map_and_markers(div element)` from another script, and in that case you don't have to use our naming scheme either.

### JSON interface

If you don't want to use the included scripts, you can skip that whole mechanism and work with the event data instead. EventVenuesController provides a simple JSON interface. Usually it's at /map and looks for addresses like this:

		/map									everything
		/map/2010							events in 2010
		/map/2010/12/					events in December 2010
		/map/2010/12/12				events on 12 December 2010

If you're using `taggable_events` then we also inherit the tag-faceting interface here.

The data returned looks like this:

		{
			
		}

## Bugs and features

[Github issues](http://github.com/spanner/radiant-event_map-extension/issues) please, or for little things an email or github message is fine.

## Author & Copyright

Copyright 2008-2010 Will at spanner.org.

Released under the same terms as Radiant and/or Rails.
